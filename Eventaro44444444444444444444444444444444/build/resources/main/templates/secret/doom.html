<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/main-layout}">
<head>
    <title>E1M1: At Doom's Gate</title>
    <script src="https://js-dos.com/cdn/js-dos-api.js"></script>
    <style>
        /* Der äußere Rahmen */
        .doom-container {
            width: 100%;
            height: 75vh;
            min-height: 600px;
            background-color: #000;
            border-radius: 4px;
            position: relative;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* FIX: Canvas füllt alles aus, aber blockiert keine Klicks mehr */
        .doom-container canvas {
            width: 100% !important;
            height: 100% !important;
            object-fit: contain !important;
            image-rendering: pixelated !important;
            /* WICHTIG: Kein z-index hier, damit die JS-DOS Steuerungsebene oben bleibt! */
            outline: none; /* Entfernt den blauen Rahmen beim Klicken */
        }

        /* Stellt sicher, dass der DOSBox-Container auch die volle Höhe nutzt */
        .dosbox-container {
            width: 100%;
            height: 100%;
        }

        .doom-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .doom-stats {
            display: flex;
            gap: 1rem;
        }
        .stat-badge {
            background-color: #c62828;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>

<div layout:fragment="content" th:with="activeMenuItem='dashboard'">

    <div style="margin-bottom: 2rem;">
        <h1 style="color: var(--dark-green); font-weight: 700;">Welcome back, Marine!</h1>
        <p class="subtitle">RIP AND TEAR UNTIL IT IS DONE.</p>
    </div>

    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.5rem; margin-bottom: 2rem;">
        <div class="card stat-card-border-red">
            <span class="stat-label">HEALTH</span>
            <span class="stat-value">100%</span>
            <span class="stat-desc">Current Condition</span>
        </div>
        <div class="card stat-card-border-orange">
            <span class="stat-label">ARMOR</span>
            <span class="stat-value">0%</span>
            <span class="stat-desc">Protection Level</span>
        </div>
        <div class="card stat-card-border-blue">
            <span class="stat-label">AMMO</span>
            <span class="stat-value">50</span>
            <span class="stat-desc">Bullets</span>
        </div>
        <div class="card stat-card-border-green">
            <span class="stat-label">STATUS</span>
            <span class="stat-value">IDDQD</span>
            <span class="stat-desc">God Mode: OFF</span>
        </div>
    </div>

    <div class="card">
        <div class="doom-header">
            <h3 style="margin: 0; color: var(--dark-green);">UAC Terminal - Phobos Anomaly</h3>
            <div class="doom-stats">
                <span class="stat-badge">Kills: 0%</span>
                <span class="stat-badge">Secrets: 0%</span>
            </div>
        </div>

        <div id="doom-canvas" class="doom-container"></div>

        <div style="margin-top: 1rem; color: #666; font-size: 0.9rem;">
            <p><strong>Steuerung:</strong> Klicke ins Bild, um die Maus zu fangen. [ESC] zum Lösen.</p>
            <p>Pfeiltasten = Bewegen | STRG = Feuern | LEERTASTE = Benutzen (Türen) | SHIFT = Rennen</p>
        </div>
    </div>

    <script>
        var dosbox = new Dosbox({
            id: "doom-canvas",
            onload: function (dosbox) {
                dosbox.run("/games/doom.zip", "./DOOM.EXE");
            },
            onrun: function (dosbox, app) {
                console.log("Doom läuft!");
            }
        });
    </script>

</div>

</body>
</html>