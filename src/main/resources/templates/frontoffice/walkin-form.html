<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>Walk-In Registration | Front Office</title>
  <link th:href="@{/css/create-event/style-create-event.css}" rel="stylesheet"/>
  <link th:href="@{/css/header_footer_backoffice.css}" rel="stylesheet"/>
</head>
<body>

<nav>
  <div class="left-section">
    <span style="font-weight: bold; font-size: 1.2rem; color: #1C481C; margin-left: 1rem;">Front Office Desk</span>
  </div>
  <ul class="nav-links">
    <li><a th:href="@{/frontoffice/dashboard}">Overview</a></li>
    <li><a class="active" th:href="@{/frontoffice/walkin}">New Walk-In</a></li>
  </ul>
  <div class="profile-box" onclick="document.getElementById('logout-form').submit();">
    <img th:src="@{/images/mariaBerger.png}" alt="profile">
    <form id="logout-form" th:action="@{/logout}" method="post" style="display: none;"></form>
  </div>
</nav>

<div class="page">
  <div class="container narrow">

    <h1 class="text-center">Walk-In Registration</h1>
    <div class="text-center" style="margin-bottom: 2rem; color: #666;">
      Register a participant directly on-site.
    </div>

    <div style="background: #e8f5e9; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem; border: 1px solid #c8e6c9;">
      <h3 th:text="${event.name}" style="margin: 0 0 0.5rem 0; color: #2e7d32;">Event Name</h3>
      <p style="margin: 0;">
        <strong>Standard Price:</strong> â‚¬<span th:text="${event.basePrice}">50.00</span> per Ticket
      </p>
    </div>

    <form th:action="@{/frontoffice/walkin}"
          th:object="${bookingRequest}"
          method="post"
          class="form-grid">

      <input type="hidden" th:field="*{eventId}">

      <div th:if="${errorMessage}" class="full-width"
           style="background: #ffebee; color: #c62828; padding: 1rem; border-radius: 4px; border: 1px solid #ef9a9a;">
        <span th:text="${errorMessage}">Error message</span>
      </div>

      <div class="section-heading full-width"><h3>Guest Details</h3></div>

      <div class="form-group">
        <label>First Name*</label>
        <input type="text" th:field="*{firstName}" required
               th:classappend="${#fields.hasErrors('firstName')} ? 'error-field'">
        <div class="field-error" th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}"></div>
      </div>

      <div class="form-group">
        <label>Last Name*</label>
        <input type="text" th:field="*{lastName}" required
               th:classappend="${#fields.hasErrors('lastName')} ? 'error-field'">
        <div class="field-error" th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}"></div>
      </div>

      <div class="form-group">
        <label>Email*</label>
        <input type="email" th:field="*{email}" placeholder="guest@local" required
               th:classappend="${#fields.hasErrors('email')} ? 'error-field'">
        <div class="field-error" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></div>
      </div>

      <div class="form-group">
        <label>Phone</label>
        <input type="text" th:field="*{phoneNumber}">
      </div>

      <div class="section-heading full-width"><h3>Address (Required for Invoice)</h3></div>

      <div class="form-group">
        <label>Street*</label>
        <input type="text" th:field="*{address.street}" required
               th:classappend="${#fields.hasErrors('address.street')} ? 'error-field'">
        <div class="field-error" th:if="${#fields.hasErrors('address.street')}" th:errors="*{address.street}"></div>
      </div>

      <div class="form-group">
        <label>House No.</label>
        <input type="text" th:field="*{address.houseNumber}"
               th:classappend="${#fields.hasErrors('address.houseNumber')} ? 'error-field'">
      </div>

      <div class="form-group">
        <label>ZIP*</label>
        <input type="text" th:field="*{address.postalCode}" required
               th:classappend="${#fields.hasErrors('address.postalCode')} ? 'error-field'">
        <div class="field-error" th:if="${#fields.hasErrors('address.postalCode')}" th:errors="*{address.postalCode}"></div>
      </div>

      <div class="form-group">
        <label>City*</label>
        <input type="text" th:field="*{address.city}" required
               th:classappend="${#fields.hasErrors('address.city')} ? 'error-field'">
        <div class="field-error" th:if="${#fields.hasErrors('address.city')}" th:errors="*{address.city}"></div>
      </div>

      <div class="form-group full-width">
        <label>Country*</label>
        <select th:field="*{address.country}" required>
          <option value="">Select country</option>
          <option th:each="c : ${countries}" th:value="${c}" th:text="${c}"></option>
        </select>
        <div class="field-error" th:if="${#fields.hasErrors('address.country')}" th:errors="*{address.country}"></div>
      </div>

      <div class="section-heading full-width"><h3>Booking & Payment</h3></div>

      <div class="form-group">
        <label>Tickets*</label>
        <input type="number" th:field="*{ticketCount}" min="1" max="50" required>
      </div>

      <div class="form-group">
        <label>Payment Method*</label>
        <select th:field="*{paymentMethod}">
          <option value="CASH_ON_SITE">Cash</option>
          <option value="CREDIT_CARD">Card Terminal</option>
        </select>
      </div>

      <div class="form-group full-width" style="background: #fff3e0; padding: 1rem; border-radius: 4px; border: 1px solid #ffe0b2; margin-top: 1rem;">
        <label style="color: #e65100; font-weight: bold;">Override Price (Total)</label>
        <input type="number" name="manualPrice" step="0.01" min="0" placeholder="Leave empty for standard price">
        <small style="display: block; margin-top: 5px; color: #666;">Only set this if you agreed on a special price (e.g. discount applied).</small>
      </div>

      <div class="button-group full-width">
        <a th:href="@{/frontoffice/dashboard}" class="btn-cancel">Cancel</a>
        <button class="btn-primary" type="submit">Complete Check-In</button>
      </div>

    </form>
  </div>
</div>
</body>
</html>